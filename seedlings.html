<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Seedlings - Kurnalpi Organics</title>

<style>
/* ===== GENERAL ===== */
* { box-sizing: border-box; margin:0; padding:0; }
body { font-family: Arial, sans-serif; background: url('background.jpg') center/cover no-repeat fixed; color: white; }
.page-wrapper { min-height: 100vh; display: flex; flex-direction: column; }

header.site-header { background-color: rgba(47,93,58,0.85); padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; }
.logo { height: 100px; width: auto; }
nav.nav { display: flex; gap: 20px; }
nav.nav a { color: white; text-decoration: none; font-weight: 600; }
nav.nav a:hover { opacity: 0.8; }

#products-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px,1fr)); gap: 20px; max-width: 1200px; margin: 30px auto; }
.product-card { background: rgba(47,93,58,0.85); padding: 15px; border-radius: 10px; color: white; text-align: center; box-shadow: 0 6px 12px rgba(0,0,0,0.3); }

.product-card h3 { margin: 10px 0 5px; }
.product-card p { font-size: 14px; margin: 5px 0; }

.price { font-weight: bold; margin: 5px 0; }
.stock { font-size: 14px; margin: 5px 0; }

.qty-box { display: flex; justify-content: center; align-items: center; margin: 10px 0; }
.qty-box input { width: 50px; text-align: center; margin: 0 5px; border-radius: 5px; }
.qty-box button { padding: 2px 8px; border:none; border-radius: 5px; cursor:pointer; }

.add-btn { background-color: #2F5D3A; border:none; color:white; padding: 8px 12px; border-radius:5px; cursor:pointer; transition:0.2s; }
.add-btn:hover { background-color: #1f3b27; }

footer { text-align: center; padding: 15px 0; background-color: rgba(47, 93, 58, 0.85); font-weight: bold; font-size: 14px; }
footer a { color:white; text-decoration:none; }
footer a:hover { text-decoration: underline; }

h1.section-title { text-align: center; margin-bottom: 30px; }

/* ===== IMAGE SLIDER ===== */
.slider {
  position: relative;
  display: inline-block;
  width: 250px;
  height: 250px;
  margin: auto;
}

.product-image {
  width: 250px;
  height: 250px;
  object-fit: contain;
  display: block;
  border-radius: 8px;
}

.slider button.prev,
.slider button.next {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background-color: rgba(0,0,0,0.4);
  color: white;
  border: none;
  font-size: 24px;
  padding: 8px 12px;
  border-radius: 50%;
  cursor: pointer;
  z-index: 2;
  user-select: none;
}

.slider button.prev { left: -15px; }
.slider button.next { right: -15px; }

.slider button.prev:hover,
.slider button.next:hover {
  background-color: rgba(0,0,0,0.7);
}

/* ===== SELECT ===== */
.options-select {
  margin: 10px 0;
  padding: 5px;
  border-radius: 5px;
  border: none;
}
</style>
</head>

<body>
<div class="page-wrapper">

<header class="site-header">
    <a href="index.html"><img src="logo.png" class="logo" alt="Kurnalpi Organics"></a>
    <nav class="nav">
    <a href="index.html">Home</a>
    <a href="about.html">About</a>
    <a href="products.html">Products</a>
    <a href="contact.html">Contact Us</a>
    <a href="cart.html">üõí <span id="cart-total">R0.00</span></a>
</nav>

</header>

<main>
    <h1 class="section-title">Seedlings</h1>
    <div id="products-container"></div>
</main>

<footer>
    &copy; 2026 Kurnalpi Organics
</footer>

<script>
// ========================
// PRODUCTS DATA
// ========================
const seedlingsProducts = [
  {
    name: "Dragon Fruit",
    images: ["dragonfruit.png", "dragonfruit1.png"],
    options: [
      { label: "15cm cutting", price: 35, stock: 50 },
      { label: "25cm cutting", price: 55, stock: 50 }
    ],
    description: "Healthy organic Dragon Fruit cuttings ready to grow."
  },
  {
    name: "Granadilla Seedlings",
    images: ["granadilla.png"],
    price: 60,
    stock: 30,
    description: "Taste of the tropics at home."
  },
  {
    name: "Pomegranate Seedling",
    images: ["poma.png"],
    price: 120,
    stock: 10,
    description: "Every pomegranate has a seed of Paradise.",
    enquire: "Please enquire for bigger trees"
  },
  {
    name: "Calla Lilly Seedling",
    images: ["cala.png"],
    price: 40,
    stock: 20,
    description: "Grow like a lily: start from the mud, bloom in brilliance."
  },
  {
    name: "Strawberry Seedlings",
    images: ["strawberry.png"],
    price: 50,
    stock: 15,
    description: "Sweet strawberry plant, perfect for a fresh, seasonal treat.",
    enquire: "Please enquire for bigger plants"
  }
];

// ========================
// CART FUNCTIONS
// ========================
function getCart() {
  return JSON.parse(localStorage.getItem("cart")) || [];
}

function saveCart(cart) {
  localStorage.setItem("cart", JSON.stringify(cart));
  updateCartTotal();
}

function updateCartTotal() {
  const cart = getCart();
  let total = 0;
  cart.forEach(i => total += i.price * i.quantity);
  const el = document.getElementById("cart-total");
  if (el) el.textContent = "R" + total.toFixed(2);
}

function addToCart(name, price, quantity = 1, image = "", pack = "", stock = Infinity) {
  const cart = getCart();
  const existing = cart.find(i => i.name === name && i.pack === pack);

  if (existing) {
    if (existing.quantity + quantity > stock) {
      alert(`Only ${stock} available for "${name}"`);
      existing.quantity = stock;
    } else {
      existing.quantity += quantity;
    }
  } else {
    cart.push({ name, price, quantity: Math.min(quantity, stock), image, pack, stock });
  }

  saveCart(cart);
}

// ========================
// RENDER PRODUCTS
// ========================
function renderProducts() {
  const container = document.getElementById("products-container");
  container.innerHTML = "";

  seedlingsProducts.forEach(prod => {
    const card = document.createElement("div");
    card.className = "product-card";

    let currentStock = prod.stock || prod.options?.[0]?.stock || 0;
    const basePrice = prod.price || prod.options?.[0]?.price || 0;

    // Options dropdown
    const optionsHTML = prod.options ? `
      <select class="options-select">
        ${prod.options.map(o => `<option value="${o.price}" data-stock="${o.stock}">${o.label} - R${o.price}</option>`).join("")}
      </select>` : "";

    // Image slider or single image
    const imageHTML = prod.images.length > 1 ? `
      <div class="slider">
        <button class="prev">‚ùÆ</button>
        <img class="product-image popup-img" src="${prod.images[0]}" data-img-index="0">
        <button class="next">‚ùØ</button>
      </div>` :
      `<img class="product-image popup-img" src="${prod.images[0]}">`;

    card.innerHTML = `
      ${imageHTML}
      <h3>${prod.name}</h3>
      <p>${prod.description}</p>
      ${prod.enquire ? `<p style="font-size:13px;font-style:italic;opacity:0.9;">${prod.enquire}</p>` : ""}
      <div class="price">R${basePrice}</div>
      ${optionsHTML}
      <p class="stock">Stock: ${currentStock}</p>

      <div class="qty-box">
        <button class="minus">‚àí</button>
        <input type="number" min="1" value="1">
        <button class="plus">+</button>
      </div>

      <button class="add-btn">Add to Cart</button>
    `;

    const qtyInput = card.querySelector("input");
    const priceDiv = card.querySelector(".price");
    const stockDiv = card.querySelector(".stock");
    const select = card.querySelector(".options-select");
    const productImage = card.querySelector(".popup-img");

    // Quantity buttons
    card.querySelector(".minus").onclick = () => { if(qtyInput.value > 1) qtyInput.value--; };
    card.querySelector(".plus").onclick = () => { if(qtyInput.value < currentStock) qtyInput.value++; };

    // Option change
    if(select) {
      select.onchange = () => {
        priceDiv.textContent = "R" + select.value;
        currentStock = parseInt(select.options[select.selectedIndex].dataset.stock);
        stockDiv.textContent = "Stock: " + currentStock;
        if(qtyInput.value > currentStock) qtyInput.value = currentStock;
      };
    }

    // Add to cart
    card.querySelector(".add-btn").onclick = () => {
      const qty = parseInt(qtyInput.value);
      if(qty > currentStock) {
        alert("Not enough stock available.");
        return;
      }
      const price = select ? parseInt(select.value) : basePrice;
      const pack = select ? select.options[select.selectedIndex].text : "";
      const name = pack ? `${prod.name} (${pack})` : prod.name;

      addToCart(name, price, qty, productImage.src, pack, currentStock);
      alert(`${qty} x "${name}" added to cart.`);
    };

    container.appendChild(card);
  });
}

// ========================
// IMAGE SLIDER FUNCTIONALITY
// ========================
document.addEventListener("click", e => {
  if (e.target.classList.contains("prev") || e.target.classList.contains("next")) {
    const slider = e.target.closest(".slider");
    const img = slider.querySelector(".product-image");
    const card = e.target.closest(".product-card");
    const productName = card.querySelector("h3").textContent.split(" (")[0];
    const product = seedlingsProducts.find(p => p.name === productName);

    let index = parseInt(img.dataset.imgIndex);
    index = e.target.classList.contains("next")
      ? (index + 1) % product.images.length
      : (index - 1 + product.images.length) % product.images.length;

    img.src = product.images[index];
    img.dataset.imgIndex = index;
  }
});

// ========================
// IMAGE POPUP ON CLICK
// ========================
function setupImagePopup() {
  const modalHTML = document.createElement("div");
  modalHTML.id = "image-modal";
  modalHTML.style.cssText = `
    display:none; position:fixed; inset:0;
    background: rgba(0,0,0,0.85);
    justify-content:center; align-items:center;
    z-index:9999; cursor:pointer;
  `;
  modalHTML.innerHTML = `<img id="modal-image" style="max-width:90%; max-height:90%; border-radius:12px;">`;
  document.body.appendChild(modalHTML);

  document.addEventListener("click", e => {
    const modal = document.getElementById("image-modal");
    const modalImg = document.getElementById("modal-image");

    if(e.target.matches(".popup-img")) {
      modal.style.display = "flex";
      modalImg.src = e.target.src;
    } else if(e.target === modal || e.target === modalImg) {
      modal.style.display = "none";
      modalImg.src = "";
    }
  });
}

// ========================
// INIT
// ========================
document.addEventListener("DOMContentLoaded", () => {
  renderProducts();
  updateCartTotal();
  setupImagePopup();
});
</script>
