<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checkout - Kurnalpi Organics</title>
<link rel="stylesheet" href="style.css">

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background-image: url('background.jpg');
    background-size: cover;
    background-attachment: fixed;
    color: white;
}

main {
    padding: 40px;
    position: relative;
}

main::before {
    content: "";
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.5);
    z-index: -1;
}

.checkout-container {
    max-width: 900px;
    margin: auto;
    background: rgba(47, 93, 58, 0.9);
    padding: 30px;
    border-radius: 10px;
}

h1, h2 {
    text-align: center;
}

.checkout-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 30px;
}

@media (max-width: 768px) {
    .checkout-grid {
        grid-template-columns: 1fr;
    }
}

label {
    display: block;
    margin-top: 10px;
}

input, textarea {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
}

th, td {
    padding: 10px;
    border-bottom: 1px solid rgba(255,255,255,0.2);
}

.summary {
    margin-top: 15px;
}

.summary p {
    display: flex;
    justify-content: space-between;
    font-size: 16px;
}

.total {
    font-size: 20px;
    font-weight: bold;
}

.checkout-btn {
    width: 100%;
    margin-top: 12px;
    padding: 12px;
    font-size: 16px;
    cursor: pointer;
    border: none;
    border-radius: 6px;
}

.whatsapp {
    background: #25d366;
    color: white;
}

.email {
    background: #ffd700;
    color: black;
}

.eft-box {
    display: none;
    margin-top: 15px;
    background: #fff;
    color: #000;
    padding: 20px;
    border-radius: 8px;
}
</style>
</head>

<body>

<header class="site-header">
    <div class="header-inner">
        <a href="index.html"><img src="logo.png" class="logo"></a>
        <nav class="nav">
            <a href="index.html">Home</a>
            <a href="products.html">Products</a>
            <a href="cart.html">Cart</a>
        </nav>
    </div>
</header>

<main>
<div class="checkout-container">
    <h1>Checkout</h1>

    <div class="checkout-grid">
        <!-- CUSTOMER DETAILS -->
        <div>
            <h2>Your Details</h2>

            <label>Name</label>
            <input id="name" required>

            <label>Phone</label>
            <input id="phone" required>

            <label>Email (optional)</label>
            <input id="email">

            <label>Delivery Address</label>
            <textarea id="address" rows="4" required></textarea>

            <label>Notes (optional)</label>
            <textarea id="notes" rows="3"></textarea>
        </div>

        <!-- ORDER SUMMARY -->
        <div>
            <h2>Order Summary</h2>

            <table>
                <thead>
                    <tr>
                        <th>Item</th>
                        <th>Qty</th>
                        <th>Price</th>
                    </tr>
                </thead>
                <tbody id="order-items"></tbody>
            </table>

            <div class="summary">
                <p><span>Subtotal</span><span id="subtotal">R0</span></p>
                <p><span>Shipping</span><span id="shipping">R80</span></p>
                <p class="total"><span>Total</span><span id="total">R0</span></p>
            </div>

            <button class="checkout-btn whatsapp" onclick="checkoutWhatsApp()">
                Checkout via WhatsApp
            </button>

            <button class="checkout-btn email" onclick="checkoutEmail()">
                Checkout via Email
            </button>

            <button class="checkout-btn email" onclick="showEFT()">
                Pay via EFT (Bank Transfer)
            </button>

            <!-- EFT DETAILS -->
            <div id="eft-box" class="eft-box">
                <h3>Bank Transfer (EFT)</h3>

                <p><strong>Bank:</strong> FNB</p>
                <p><strong>Account Name:</strong> Kurnalpi Organics</p>
                <p><strong>Account Number:</strong> 1234567890</p>
                <p><strong>Branch Code:</strong> 250655</p>
                <p><strong>Account Type:</strong> Cheque</p>

                <p style="margin-top:10px;">
                    <strong>Payment Reference:</strong>
                    <span id="eft-reference"></span>
                </p>

                <p>Please use this reference when making payment.</p>
            </div>
        </div>
    </div>
</div>
</main>

<footer>
    &copy; 2026 Kurnalpi Organics
</footer>

<script>
const SHIPPING_FEE = 80;

function getCart() {
    return JSON.parse(localStorage.getItem("cart")) || [];
}

function loadCheckout() {
    const cart = getCart();
    const tbody = document.getElementById("order-items");
    let subtotal = 0;

    tbody.innerHTML = "";

    cart.forEach(item => {
        const itemTotal = item.price * item.quantity;
        subtotal += itemTotal;

        tbody.innerHTML += `
            <tr>
                <td>${item.name}</td>
                <td>${item.quantity}</td>
                <td>R${itemTotal.toFixed(2)}</td>
            </tr>
        `;
    });

    document.getElementById("subtotal").textContent = "R" + subtotal.toFixed(2);
    document.getElementById("total").textContent =
        "R" + (subtotal + SHIPPING_FEE).toFixed(2);
}

function generateReference() {
    return "KO-" + Math.floor(100000 + Math.random() * 900000);
}

function buildMessage() {
    const cart = getCart();
    let message = "ORDER DETAILS:%0A%0A";

    cart.forEach(item => {
        message += `${item.name} x ${item.quantity} - R${(item.price * item.quantity).toFixed(2)}%0A`;
    });

    const subtotal = cart.reduce((t, i) => t + i.price * i.quantity, 0);
    const total = subtotal + SHIPPING_FEE;

    message += `%0ASubtotal: R${subtotal.toFixed(2)}`;
    message += `%0AShipping: R${SHIPPING_FEE.toFixed(2)}`;
    message += `%0ATotal: R${total.toFixed(2)}%0A%0A`;

    message += `Name: ${name.value}%0A`;
    message += `Phone: ${phone.value}%0A`;
    message += `Address: ${address.value}%0A`;

    const ref = document.getElementById("eft-reference").textContent;
    if (ref) message += `Payment Ref: ${ref}%0A`;

    return message;
}

function checkoutWhatsApp() {
    window.open(
        `https://wa.me/27123456789?text=${buildMessage()}`,
        "_blank"
    );
}

function checkoutEmail() {
    window.location.href =
        `mailto:info@example.com?subject=New Order&body=${buildMessage()}`;
}

function showEFT() {
    const ref = generateReference();
    document.getElementById("eft-reference").textContent = ref;
    document.getElementById("eft-box").style.display = "block";
}

document.addEventListener("DOMContentLoaded", loadCheckout);
</script>

</body>
</html>
