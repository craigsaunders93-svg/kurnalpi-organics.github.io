<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Your Cart - Kurnalpi Organics</title>
<link rel="stylesheet" href="style.css">

<style>
/* ======== PAGE STYLING ======== */
body {
    font-family: Arial, sans-serif;
    background-image: url('background.jpg');
    background-size: cover;
    background-attachment: fixed;
    margin: 0;
    color: white;
}

.page-wrapper {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

header, .site-header {
    background-color: rgba(47, 93, 58, 0.85);
    padding: 15px 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

header .nav a {
    color: white;
    text-decoration: none;
    margin-left: 15px;
    font-weight: 600;
}

header .nav a:hover { opacity: 0.8; }

main {
    flex: 1;
    padding: 40px;
    position: relative;
}

main::before {
    content: "";
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.5);
    z-index: -1;
}

/* ======== CART CONTAINER ======== */
.cart-container {
    max-width: 1000px;
    margin: auto;
    background: rgba(47, 93, 58, 0.9);
    padding: 30px;
    border-radius: 10px;
}

h1 {
    text-align: center;
    margin-bottom: 20px;
}

#cart-message {
    text-align: center;
    margin: 20px 0;
    font-size: 18px;
}

/* ======== CART TABLE ======== */
table {
    width: 100%;
    border-collapse: collapse;
}

th, td {
    padding: 12px;
    text-align: center;
    border-bottom: 1px solid rgba(255,255,255,0.2);
}

th {
    background: rgba(0,0,0,0.3);
}

.cart-item img {
    display: block;
    margin: auto;
    border-radius: 6px;
    width: 80px;
    height: 80px;
    object-fit: cover;
}

.qty-btn {
    padding: 5px 10px;
    font-size: 16px;
    cursor: pointer;
    border: none;
    background: #1f4d30;
    color: white;
    border-radius: 4px;
}

.qty-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.qty-input {
    width: 50px;
    text-align: center;
    font-size: 16px;
    padding: 4px;
    margin: 0 5px;
    border-radius: 4px;
    border: 1px solid #ccc;
}

.remove-btn {
    background: #c0392b;
    color: white;
    border: none;
    padding: 6px 10px;
    cursor: pointer;
    border-radius: 4px;
}

.remove-btn:hover {
    background: #e74c3c;
}

/* ======== CART FOOTER ======== */
.cart-footer {
    margin-top: 20px;
    text-align: right;
}

#cart-grand-total {
    font-size: 20px;
    margin-bottom: 10px;
}

.checkout-btn {
    margin-top: 15px;
    background: #ffd700;
    color: black;
    padding: 12px 20px;
    border: none;
    font-size: 16px;
    cursor: pointer;
    border-radius: 6px;
}

.checkout-btn:hover {
    background: #ffcc00;
}
</style>
</head>

<body>
<div class="page-wrapper">

<!-- ======== HEADER ======== -->
<header class="site-header">
    <a href="index.html">
        <img src="logo.png" class="logo" alt="Kurnalpi Organics">
    </a>
    <nav class="nav">
        <a href="index.html">Home</a>
        <a href="about.html">About</a>
        <a href="products.html">Products</a>
        <a href="contact.html">Contact Us</a>
        <a href="cart.html" class="cart">ðŸ›’ <span id="cart-total">R0.00</span></a>
    </nav>
</header>

<!-- ======== MAIN ======== -->
<main>
    <div class="cart-container">
        <h1>Your Shopping Cart</h1>
        <p id="cart-message"></p>

        <table>
            <thead>
                <tr>
                    <th>Image</th>
                    <th>Product</th>
                    <th>Pack</th>
                    <th>Price</th>
                    <th>Quantity</th>
                    <th>Subtotal</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="cart-items"></tbody>
        </table>

        <div class="cart-footer">
            <h2 id="cart-grand-total">Total: R0.00</h2>
            <button class="checkout-btn" id="proceed-checkout">Proceed to Checkout</button>
        </div>
    </div>
</main>

<footer>
    &copy; 2026 Kurnalpi Organics. All rights reserved.
</footer>

</div>

<!-- ======== CART JS ======== -->
<script>
// ========================
// CART.JS â€“ Synced with Products page
// ========================

// Get cart from localStorage
function getCart() {
    return JSON.parse(localStorage.getItem("cart")) || [];
}

// Save cart to localStorage
function saveCart(cart) {
    localStorage.setItem("cart", JSON.stringify(cart));
    updateCartHeader();
}

// Update cart total in header
function updateCartHeader() {
    const cart = getCart();
    let total = 0;
    cart.forEach(item => total += item.price * item.quantity);
    const headerTotal = document.getElementById("cart-total");
    if (headerTotal) headerTotal.textContent = "R" + total.toFixed(2);
}

// Render cart table
function renderCartPage() {
    const cart = getCart();
    const tbody = document.getElementById("cart-items");
    const message = document.getElementById("cart-message");
    const grandTotalElem = document.getElementById("cart-grand-total");

    tbody.innerHTML = "";

    if (cart.length === 0) {
        if (message) message.textContent = "Your cart is currently empty.";
        if (grandTotalElem) grandTotalElem.textContent = "Total: R0.00";
        updateCartHeader();
        return;
    }

    if (message) message.textContent = "";

    let grandTotal = 0;
    cart.forEach((item, index) => {
        const subtotal = item.price * item.quantity;
        grandTotal += subtotal;

        const row = document.createElement("tr");
        row.className = "cart-item";
        row.innerHTML = `
            <td><img src="${item.image || 'placeholder.png'}" alt="${item.name}"></td>
            <td>${item.name}</td>
            <td>${item.pack || '-'}</td>
            <td>R${item.price.toFixed(2)}</td>
            <td>
                <button class="qty-btn minus" data-index="${index}" ${item.quantity <= 1 ? 'disabled' : ''}>âˆ’</button>
                <input type="number" class="qty-input" min="1" value="${item.quantity}" data-index="${index}">
                <button class="qty-btn plus" data-index="${index}">+</button>
            </td>
            <td>R${subtotal.toFixed(2)}</td>
            <td><button class="remove-btn" data-index="${index}">Remove</button></td>
        `;
        tbody.appendChild(row);
    });

    if (grandTotalElem) grandTotalElem.textContent = `Total: R${grandTotal.toFixed(2)}`;
    updateCartHeader();
    attachCartActions();
}

// Attach quantity & remove actions
function attachCartActions() {
    const cart = getCart();

    document.querySelectorAll(".qty-btn").forEach(btn => {
        btn.onclick = () => {
            const index = parseInt(btn.dataset.index);
            if (btn.classList.contains("minus") && cart[index].quantity > 1) cart[index].quantity--;
            if (btn.classList.contains("plus")) cart[index].quantity++;
            saveCart(cart);
            renderCartPage();
        };
    });

    document.querySelectorAll(".qty-input").forEach(input => {
        input.onchange = () => {
            const index = parseInt(input.dataset.index);
            let qty = parseInt(input.value);
            if (isNaN(qty) || qty < 1) qty = 1;
            cart[index].quantity = qty;
            saveCart(cart);
            renderCartPage();
        };
    });

    document.querySelectorAll(".remove-btn").forEach(btn => {
        btn.onclick = () => {
            const index = parseInt(btn.dataset.index);
            cart.splice(index, 1);
            saveCart(cart);
            renderCartPage();
        };
    });
}

// Proceed to checkout
function attachCheckoutButton() {
    const btn = document.getElementById("proceed-checkout");
    if (!btn) return;
    btn.onclick = () => {
        if (getCart().length === 0) {
            alert("Your cart is empty!");
            return;
        }
        window.location.href = "checkout.html";
    };
}

// Initialize
document.addEventListener("DOMContentLoaded", () => {
    renderCartPage();
    attachCheckoutButton();
});
</script>

</body>
</html>
